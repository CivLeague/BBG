-- Author/credit: D. / Jack The Narrator, 2019
--
-- Integration in this mod has been authorised by the Author, full project details included in the notice file located in this folder.
-- The following code was originally developed specifically for integration into this mod. A big thank you to Jack for the assist.
-- He is a very gifted modder, and you can check out his other projects on GitHub and/or Steam: 
-- https://github.com/d-jackthenarrator
-- https://steamcommunity.com/profiles/76561197967385197/
function NoMoreStack()
	print("No more stack check turn", Game.GetCurrentGameTurn())
	if ( Game.GetCurrentGameTurn() ~= GameConfiguration.GetStartTurn()) then
	for i = 0, PlayerManager.GetAliveMajorsCount() - 1 do
		if (PlayerConfigurations[i]:GetLeaderTypeName() ~= "LEADER_SPECTATOR" and PlayerConfigurations[i]:GetHandicapTypeID() ~= 2021024770) then
			local pPlayerCulture:table = Players[i]:GetCulture();
			if pPlayerCulture:GetProgressingCivic() == -1 and pPlayerCulture:GetCultureYield()>0 then
				print("Player",PlayerConfigurations[i]:GetLeaderTypeName()," forgot to pick a civic")
				for k = 0, 58 do
					if (pPlayerCulture:HasCivic(k) == false) then
						pPlayerCulture:SetProgressingCivic(k)
						break
					end	
				end
			end
			local pPlayerTechs:table = Players[i]:GetTechs();
			if pPlayerTechs:GetResearchingTech() == -1 and pPlayerTechs:GetScienceYield()>0 then
				print("Player",PlayerConfigurations[i]:GetLeaderTypeName()," forgot to pick a tech")
				for k = 0, 73 do
					if (pPlayerTechs:HasTech(k) == false) then
						pPlayerTechs:SetResearchingTech(k)
						break
					end	
				end
			end
		end		
	end
	end	
end

function Initialize()

print("Culture Stack 2.1")
GameEvents.OnGameTurnStarted.Add(NoMoreStack);

end

Initialize();