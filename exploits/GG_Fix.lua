ExposedMembers.LuaEvents = LuaEvents

function DoGGFix(playerID:number, unitID:number)
	local currentTurn = Game.GetCurrentGameTurn();
	local pUnit = UnitManager.GetUnit(playerID, unitID)
	local unitAbilities = pUnit:GetAbility()
	if unitAbilities ~= nil then
		if (unitAbilities:GetAbilityCount("ABILITY_GREAT_GENERAL_MOVEMENT")>0) then
			unitAbilities:ChangeAbilityCount("ABILITY_GREAT_GENERAL_MOVEMENT",-1)
		end
		if (unitAbilities:GetAbilityCount("ABILITY_GREAT_GENERAL_STRENGTH")>0) then
			unitAbilities:ChangeAbilityCount("ABILITY_GREAT_GENERAL_STRENGTH",-1)
		end
	end	
end

function DoGGFixAdd(playerID:number, unitID:number)
	local currentTurn = Game.GetCurrentGameTurn();
	local pUnit = UnitManager.GetUnit(playerID, unitID)
	local unitAbilities = pUnit:GetAbility()
	if unitAbilities ~= nil then
		if (unitAbilities:GetAbilityCount("ABILITY_GREAT_GENERAL_MOVEMENT")<1) then
			unitAbilities:ChangeAbilityCount("ABILITY_GREAT_GENERAL_MOVEMENT",1)
		end
		if (unitAbilities:GetAbilityCount("ABILITY_GREAT_GENERAL_STRENGTH")<1) then
			unitAbilities:ChangeAbilityCount("ABILITY_GREAT_GENERAL_STRENGTH",1)
		end
	end	
end

function DoGAFix(playerID:number, unitID:number)
	local currentTurn = Game.GetCurrentGameTurn();
	local pUnit = UnitManager.GetUnit(playerID, unitID)
	local unitAbilities = pUnit:GetAbility()
	if unitAbilities ~= nil then
		if (unitAbilities:GetAbilityCount("ABILITY_GREAT_ADMIRAL_MOVEMENT")>0) then
			unitAbilities:ChangeAbilityCount("ABILITY_GREAT_ADMIRAL_MOVEMENT",-1)
		end
		if (unitAbilities:GetAbilityCount("ABILITY_GREAT_ADMIRAL_STRENGTH")>0) then
			unitAbilities:ChangeAbilityCount("ABILITY_GREAT_ADMIRAL_STRENGTH",-1)
		end
	end	
end

function DoGAFixAdd(playerID:number, unitID:number)
	local currentTurn = Game.GetCurrentGameTurn();
	local pUnit = UnitManager.GetUnit(playerID, unitID)
	local unitAbilities = pUnit:GetAbility()
	if unitAbilities ~= nil then
		if (unitAbilities:GetAbilityCount("ABILITY_GREAT_ADMIRAL_MOVEMENT")<1) then
			unitAbilities:ChangeAbilityCount("ABILITY_GREAT_ADMIRAL_MOVEMENT",1)
		end
		if (unitAbilities:GetAbilityCount("ABILITY_GREAT_ADMIRAL_STRENGTH")<1) then
			unitAbilities:ChangeAbilityCount("ABILITY_GREAT_ADMIRAL_STRENGTH",1)
		end
	end	
end

function Initialize()

LuaEvents.UIDoGGFix.Add ( DoGGFix );
LuaEvents.UIDoGGFix_2.Add ( DoGGFixAdd );
LuaEvents.UIDoGAFix.Add ( DoGAFix );
LuaEvents.UIDoGAFix_2.Add ( DoGAFixAdd );

end

Initialize();